<div [@routerTransition]>
    <div class="container-fluid">
        <div class="row p-0">
            <div class="col-12 p-0">
                <div class="card justify-content-between p-3 mb-8">
                    <div class="d-flex flex-row">
                        <div class="d-flex">
                            <h4>
                                {{ title }}
                                <small class="text-body-secondary">{{ subtitle }}</small>
                            </h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div [class]="containerClass + ' kt-grid__item kt-grid__item--fluid'">
        <div class="kt-portlet kt-portlet--mobile">
            <div class="kt-portlet__body">
                <div class="row g-3">
                    <div class="col-md-12 align-items-stretch">
                        <div class="card card-height-100">
                            <div class="card-header border-bottom-dashed">
                                <h6 class="card-title mb-0">{{ headerInfo }}</h6>
                                <button (click)="create()" class="btn btn-primary blue">
                                    <i class="fa fa-plus"></i>
                                    {{ l('CreateNew') }}
                                </button>
                            </div>

                            <div class="card-header">
                                <div class="container">
                                    <form class="kt-form" autocomplete="off">
                                        <div class="row">
                                            <div class="row align-items-center">
                                                <div class="col-xl-12">
                                                    <div class="form-group m-form__group align-items-center">
                                                        <div class="input-group">
                                                            <input
                                                                [(ngModel)]="filterText"
                                                                name="filterText"
                                                                autoFocus
                                                                class="form-control m-input"
                                                                [placeholder]="l('SearchWithThreeDot')"
                                                                type="text"
                                                            />
                                                            <span class="input-group-btn">
                                                                <button
                                                                    (click)="getAll()"
                                                                    class="btn btn-primary"
                                                                    type="submit"
                                                                >
                                                                    <i class="flaticon-search-1"></i>
                                                                </button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-xl-3 mt-2 mb-2">
                                                    <button
                                                        type="button"
                                                        class="btn btn-secondary btn-sm p-2 f-7 my-2"
                                                        *ngIf="!advancedFiltersAreShown"
                                                        (click)="advancedFiltersAreShown = !advancedFiltersAreShown"
                                                    >
                                                        {{ l('ShowMoreFilters') }}
                                                        <i class="flaticon2-down"></i>
                                                    </button>
                                                    <button
                                                        type="button"
                                                        class="btn btn-secondary btn-sm p-2 f-7 my-2"
                                                        *ngIf="advancedFiltersAreShown"
                                                        (click)="advancedFiltersAreShown = !advancedFiltersAreShown"
                                                    >
                                                        {{ l('ShowLessFilters') }}
                                                        <i class="flaticon2-up"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="row" [hidden]="!advancedFiltersAreShown">
                                                <div class="col-md-12">
                                                    <div class="kt-separator kt-separator--border-dashed"></div>
                                                </div>

                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="TitleFilter">{{ l('Title') }}</label>
                                                        <input
                                                            type="text"
                                                            class="form-control"
                                                            id="TitleFilter"
                                                            name="titleFilter"
                                                            [(ngModel)]="titleFilter"
                                                        />
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <label for="PublishFilterSelect">{{ l('Publish') }}</label>
                                                    <select
                                                        class="form-select"
                                                        name="PublishFilter"
                                                        id="PublishFilterSelect"
                                                        [(ngModel)]="publishFilter"
                                                    >
                                                        <option value="-1">{{ l('All') }}</option>
                                                        <option value="0">{{ l('False') }}</option>
                                                        <option value="1">{{ l('True') }}</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>

                            <!--<Primeng-Datatable-Start>-->
                            <div class="primeng-datatable-container col-12" [busyIf]="primengTableHelper.isLoading">
                                <p-table
                                    #dataTable
                                    (onLazyLoad)="getAll($event)"
                                    [value]="primengTableHelper.records"
                                    rows="{{ primengTableHelper.defaultRecordsCountPerPage }}"
                                    [paginator]="false"
                                    [lazy]="true"
                                    [scrollable]="true"
                                    ScrollWidth="100%"
                                    [responsive]="primengTableHelper.isResponsive"
                                    [resizableColumns]="primengTableHelper.resizableColumns"
                                    styleClass="p-datatable-striped"
                                >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th
                                                style="width: 130px"
                                                [hidden]="
                                                    !isGrantedAny(
                                                        'Pages.CatAccountStatuses.Edit',
                                                        'Pages.CatAccountStatuses.Delete'
                                                    )
                                                "
                                            >
                                                {{ l('Actions') }}
                                            </th>
                                            <th style="width: 150px" pSortableColumn="title">
                                                {{ l('Title') }}
                                                <p-sortIcon field="catDefault.title"></p-sortIcon>
                                            </th>
                                            <th style="width: 150px" pSortableColumn="publish">
                                                {{ l('Publish') }}
                                                <p-sortIcon field="catDefault.publish"></p-sortIcon>
                                            </th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                                        <tr>
                                            <td style="width: 130px">
                                                <div class="btn-group dropdown" dropdown container="body">
                                                    <button
                                                        class="dropdown-toggle btn btn-sm btn-primary"
                                                        dropdownToggle
                                                    >
                                                        <i class="fa fa-cog"></i>
                                                        <span class="caret"></span>
                                                        {{ l('Actions') }}
                                                    </button>
                                                    <ul class="dropdown-menu" *dropdownMenu>
                                                        <li>
                                                            <a
                                                                href="javascript:;"
                                                                (click)="viewCatDefaultModal.show(record)"
                                                            >
                                                                {{ l('View') }}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a
                                                                href="javascript:;"
                                                                (click)="
                                                                    createOrEditCatDefaultModal.show(
                                                                        service,
                                                                        record.record.id
                                                                    )
                                                                "
                                                            >
                                                                {{ l('Edit') }}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="javascript:;" (click)="delete(record.record)">
                                                                {{ l('Delete') }}
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </td>
                                            <td style="width: 150px">
                                                {{ record.record.title }}
                                            </td>
                                            <td style="width: 150px">
                                                <div *ngIf="record.record.publish" class="text-center">
                                                    <span class="badge text-bg-primary">{{ l('Yes') }}</span>
                                                </div>
                                                <div *ngIf="!record.record.publish" class="text-center">
                                                    <span class="badge text-bg-secondary">{{ l('No') }}</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                                <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                    {{ l('NoData') }}
                                </div>
                                <div class="primeng-paging-container">
                                    <p-paginator
                                        [rows]="primengTableHelper.defaultRecordsCountPerPage"
                                        #paginator
                                        (onPageChange)="getAll($event)"
                                        [totalRecords]="primengTableHelper.totalRecordsCount"
                                        [rowsPerPageOptions]="primengTableHelper.predefinedRecordsCountPerPage"
                                        [showCurrentPageReport]="true"
                                        [currentPageReportTemplate]="
                                            'TotalRecordsCount' | localize : primengTableHelper.totalRecordsCount
                                        "
                                    ></p-paginator>
                                </div>
                            </div>
                            <!--<Primeng-Datatable-End>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <createOrEditCatDefaultModal #createOrEditCatDefaultModal (modalSave)="getAll()"></createOrEditCatDefaultModal>
    <viewCatDefaultModal #viewCatDefaultModal></viewCatDefaultModal>
</div>
