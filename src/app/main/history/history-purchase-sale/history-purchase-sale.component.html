<div class="ae-table">
  <div class="primeng-datatable-container col-12" [busyIf]="primengTableHelper.isLoading">
    <p-table
      #dataTable
      (onLazyLoad)="getAllMemberRequests($event)"
      [value]="primengTableHelper.records"
      rows="{{ primengTableHelper.defaultRecordsCountPerPage }}"
      selectionMode="single" 
      (onRowSelect)="onRowSelect($event)"
      [paginator]="false"
      [lazy]="true"
      [scrollable]="true"
      ScrollWidth="100%"
      [responsive]="primengTableHelper.isResponsive"
      [resizableColumns]="primengTableHelper.resizableColumns"
    >
      <ng-template pTemplate="header">
          <tr>
            <th>
                {{ l('Active') }}
            </th>
            <th>
                {{ l('Tipo') }}
            </th>
            <th>
              {{ l('Cantidad') }}
            </th>
            <th>
                {{ l('Total USD') }}
            </th>
            <th>
                {{ l('Date') }}
            </th>
            <th>
                {{ l('Estado') }}
            </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
        <tr [pSelectableRow]="record">
          <td>
            <div class="flex align-items-center">
              <div class="mr-4">
                  <img
                      src="/assets/crypto-icons/{{ record.cryptoCurrency.key | lowercase }}.png"
                      class="crypto-icon-table"
                      alt="{{ record.cryptoCurrency.key }}"
                  />
              </div>
              <div class="ae-text__coin">
                  <p class="m-0 ae-text-dark ae-text-default">{{ record.cryptoCurrency.name }}</p>
                  <span class="ae-text-gris-dark ae-text-default">{{ record.cryptoCurrency.key }}</span>
              </div>
          </div>
          </td>
          <td class="ae-text-gris-dark ae-text-default">
            {{ l(requestType[record.request.type]) }}
          </td>
          <td class="ae-text-gris-dark ae-text-default">
            {{ record.request.cost | number : '1.0-6' : 'en' }}
          </td>
          <td class="ae-text-gris-dark ae-text-default">
            {{ record.request.amount | currency : 'USD' : 'symbol' : '1.2-5' : 'en' }}
          </td>
          <td class="ae-text-gris-dark ae-text-default">
            {{  getDateTimeFormat(record.request.creationTime) }} </td>
          <td
            class="ae-text-gris-dark"
            [class.ae-text-success]="record.request.status === 2"
            [class.ae-text-danger]="record.request.status === 3">
            {{ l(requestStatus[record.request.status]) }}
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
      {{ l('NoData') }}
    </div>
    <div class="ae-resumen__history" *ngIf="detailHistory">
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Código de referencia</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-network ae-text-default fw-semibold w-full">{{ detailHistory.folio }}</span>
          </div>
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Precio por moneda</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{ detailHistory.price | currency : 'USD' : 'symbol-narrow' : '1.2-5' : 'en' }}</span>
          </div>
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Compra</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{ detailHistory.cost }} {{ detailHistory.key }}</span>
          </div>
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Subtotal</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{ detailHistory.amount | currency : 'USD' : 'symbol-narrow' : '1.2-5' : 'en' }}</span>
          </div>
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Comisión</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{ detailHistory.feeAmount | currency : 'USD' : 'symbol-narrow' : '1.2-5' : 'en' }}</span>
          </div>            
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
          <div class="ae-description">
              <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">Total</p>
          </div>
          <div class="ae-content">
              <span class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{ (detailHistory.amount + detailHistory.feeAmount) | currency : 'USD' : 'symbol-narrow' : '1.2-5' : 'en' }}</span>
          </div>
      </div>
      <div class="ae-resumen__item flex align-items-center justify-content-between">
        <div class="ae-description">
            <p class="ae-text-gris-dark ae-text-default fw-semibold w-full">{{  getDateTimeFormat(detailHistory.creationTime) }}</p>
        </div>
        <div class="ae-content">
            <span 
              class="ae-text-default ae-text-primary fw-semibold w-full" 
              [class.ae-text-success]="detailHistory.status === 3"
              [class.ae-text-danger]="detailHistory.status === 4"
            >
              {{ l(requestStatus[detailHistory.status]) }}
            </span>
        </div>            
      </div>
    </div>
    <div class="ae-paginator primeng-paging-container flex align-items-center justify-content-center">
        <p-paginator
            [rows]="primengTableHelper.defaultRecordsCountPerPage"
            #paginator
            (onPageChange)="getAllMemberRequests($event)"
            [totalRecords]="primengTableHelper.totalRecordsCount"
            [showCurrentPageReport]="false"
        ></p-paginator>
    </div>
  </div>
</div>