<div class="ae-table">
    <div class="primeng-datatable-container col-12" [busyIf]="primengTableHelper.isLoading">
        <p-table
            #dataTable
            (onLazyLoad)="getAllMemberRequests($event)"
            [value]="primengTableHelper.records"
            rows="{{ primengTableHelper.defaultRecordsCountPerPage }}"
            selectionMode="single"
            [paginator]="false"
            [lazy]="true"
            [scrollable]="true"
            ScrollWidth="100%"
            [responsive]="primengTableHelper.isResponsive"
            [resizableColumns]="primengTableHelper.resizableColumns"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th>
                        {{ l('Active') }}
                    </th>
                    <th>
                        {{ l('Type') }}
                    </th>
                    <th>
                        {{ l('Quantity') }}
                    </th>
                    <th>
                        {{ l('TotalUSD') }}
                    </th>
                    <th>
                        {{ l('Date') }}
                    </th>
                    <th>
                        {{ l('State') }}
                    </th>
                    <th class="text-center">
                        {{ l('Actions') }}
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                <tr [pSelectableRow]="record">
                    <td>
                        <div class="flex align-items-center">
                            <div class="mr-4">
                                <img
                                    src="/assets/crypto-icons/{{ record.cryptoCurrency.key | lowercase }}.png"
                                    class="crypto-icon-table"
                                    alt="{{ record.cryptoCurrency.key }}"
                                />
                            </div>
                            <div class="ae-text__coin">
                                <p class="m-0 ae-text-dark ae-text-default">{{ record.cryptoCurrency.name }}</p>
                                <span class="ae-text-gris-dark ae-text-default">{{ record.cryptoCurrency.key }}</span>
                            </div>
                        </div>
                    </td>
                    <td class="ae-text-gris-dark ae-text-default">
                        {{ l(requestType[record.request.type]) }}
                    </td>
                    <td class="ae-text-gris-dark ae-text-default">
                        {{ record.request.amount | number : '1.0-8' : 'en' }}
                    </td>
                    <td class="ae-text-gris-dark ae-text-default">
                        {{ record.request.total | currency : 'USD' : 'symbol' : '1.2-8' : 'en' }}
                    </td>
                    <td class="ae-text-gris-dark ae-text-default">
                        {{ getDateTimeFormat(record.request.creationTime) }}
                    </td>
                    <td
                        class="ae-text-default ae-text-primary"
                        [class.ae-text-success]="record.request.status === 3"
                        [class.ae-text-danger]="record.request.status === 4"
                    >
                        {{ l(requestStatus[record.request.status]) }}
                    </td>
                    <td class="text-center">
                        <div
                            class="d-flex justify-content-center"
                            *ngIf="openDialog && record.request.id === selectRecordId"
                        >
                            <div class="spinner-border text-gray-400 spinner-small" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <span class="ms-2 mt-0 ae-text-gris-dark ae-text-small">{{ l('Loading') }}</span>
                        </div>
                        <i
                            *ngIf="!openDialog && record.request.id !== selectRecordId"
                            class="pi pi-search ae-cursor-pointer"
                            tooltip="{{ 'View' | localize }}"
                            (click)="selectRow(record.request)"
                        ></i>
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
            {{ l('NoData') }}
        </div>
        <div class="ae-paginator primeng-paging-container flex align-items-center justify-content-center">
            <p-paginator
                [rows]="primengTableHelper.defaultRecordsCountPerPage"
                #paginator
                (onPageChange)="getAllMemberRequests($event)"
                [totalRecords]="primengTableHelper.totalRecordsCount"
                [showCurrentPageReport]="false"
            ></p-paginator>
        </div>
    </div>
</div>
